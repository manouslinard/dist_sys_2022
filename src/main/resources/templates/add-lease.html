<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport"
	content="width=device-width, initial-scale=1.0 user-scalable=no">
<title>Create Lease</title>
<link rel="stylesheet" type="text/css" th:href="@{/css/style.css}" />
<script th:src="@{/js/app.js}"></script>
</head>
<body>
	<div th:replace="page_layout/slider-header :: header"></div>
	<form th:action="@{/leaseform}" th:object="${lease}" method="post"
		id="subForm">
		<div>
			<label for="title" class="form-label-required">Title</label> <input
				type="text" th:field="*{title}" id="title"
				placeholder="Title" class="form-control">
			<div id="title-error" class="error" style="display: none">Invalid
				Title.</div>
			  <span th:if="${#fields.hasErrors('title')}" th:errors="*{title}" class="error"></span>
			<br>
		</div>
		<div>
			<label for="tenant_username" class="form-label-required">Tenant Username</label> <input
				type="text" th:field="*{tenant_username}" id="tenant_username"
				placeholder="Tenant Username" class="form-control">
			<div id="username-error" class="error" style="display: none">Invalid
				Username.</div>
			  <span th:if="${#fields.hasErrors('tenant_username')}" th:errors="*{tenant_username}" class="error"></span>
			<br>
		</div>
		
		
		<table class="table-form">
			<tr>
				<td>Address</td>
				<td style="width: 35%">Municipality</td>
				<td style="width: 25%">Postal Code</td>
			</tr>
			<tr>
				<td><input type="text" th:field="*{address}" id="address"
					placeholder="Address" class="form-control"> <span
					th:if="${#fields.hasErrors('address')}" th:errors="*{address}"></span>
				</td>
				<td><input type="text" th:field="*{dimos}" id="dimos"
					placeholder="Municipality" class="form-control"> <span
					th:if="${#fields.hasErrors('dimos')}" th:errors="*{dimos}"></span>
				</td>
				<td><input type="number" th:field="*{tk}" id="tk" min="0"
					placeholder="Code" class="form-control"> <span
					th:if="${#fields.hasErrors('tk')}" th:errors="*{tk}"></span></td>
			</tr>
		</table>
		<table class="table-form">
			<tr>
				<td style="width: 30%">Cost</td>
				<td>Reason</td>
			</tr>
			<tr>
				<td><input type="number" step="0.01" min="0" th:field="*{cost}"
					id="cost" placeholder="Cost" class="form-control"> <span
					th:if="${#fields.hasErrors('cost')}" th:errors="*{cost}"></span></td>
				<td><input type="text" th:field="*{reason}" id="reason"
					placeholder="Reason" class="form-control"> <span
					th:if="${#fields.hasErrors('reason')}" th:errors="*{reason}"></span>
				</td>
			</tr>
		</table>
		<table class="table-form">
			<tr>
				<td>Start Date</td>
				<td>End Date</td>
			</tr>
			<tr>
				<td><input type="date" th:field="*{startDate}" id="startDate"
					placeholder="Start Date" class="form-control"> <span
					th:if="${#fields.hasErrors('startDate')}" th:errors="*{startDate}"></span>
				</td>
				<td><input type="date" th:field="*{endDate}" id="endDate"
					placeholder="End Date" class="form-control"> <span
					th:if="${#fields.hasErrors('endDate')}" th:errors="*{endDate}"></span>
				</td>
			</tr>
		</table>
			<div id="startdate-error" class="error" style="display: none; margin-bottom: 13px;">Start date should be before end date.</div>

		<table class="table-form">
			<tr>
				<td>Special Condition</td>
				<td style="width: 27%">Dei Number</td>
			</tr>
			<tr>
				<td><input type="text" th:field="*{sp_con}" id="sp_con"
					placeholder="Special Condition" class="form-control"> <span
					th:if="${#fields.hasErrors('sp_con')}" th:errors="*{sp_con}"></span>
				</td>
				<td><input type="number" th:field="*{dei}" id="dei"
					placeholder="Number" class="form-control" min="0"> <span
					th:if="${#fields.hasErrors('dei')}" th:errors="*{dei}"></span></td>
			</tr>
		</table>
		<button type="submit" id="submitButtonForm">Submit</button>
	</form>
	
	<script>
		// light-dark mode:
		let slider = document.getElementById("myRange");
		let body = document.querySelector("body");
		const form = document.getElementById("subForm");

		initializeBrightnessSlider(slider);

		// check inputs:
		var inputUsername = document.getElementById("tenant_username");
		var inputTitle = document.getElementById("title");
		var inStartDate = document.getElementById("startDate");
		var inEndDate = document.getElementById("endDate");
		var submitButton = document.getElementById("submitButtonForm");

		initSpanRemover([inputUsername, inputTitle]);
		
		submitButton.addEventListener("click", function(e) {
			  e.preventDefault();
			  if (!isEmptyOrSpaces(inputUsername) && !isNotValidTitle(inputTitle) && isDateSmaller(inStartDate,inEndDate)) {
				  form.submit();
			  } else {
				  if(isEmptyOrSpaces(inputUsername)) {
						document.getElementById("username-error").style.display = "block";
					  inputUsername.style.borderColor = "red";					  
				  }
				  if(isNotValidTitle(inputTitle)) {
						document.getElementById("title-error").style.display = "block";
					  inputTitle.style.borderColor = "red";
				  }
				  checkDates(inStartDate, inEndDate);
			  }
			});
		
		
		inputUsername.addEventListener("blur", function() {
			if (isEmptyOrSpaces(inputUsername)) {
				document.getElementById("username-error").style.display = "block";
				inputUsername.style.borderColor = "red";
			} else {
				document.getElementById("username-error").style.display = "none";
				inputUsername.style.borderColor = "black";
			}
		});

		inputTitle.addEventListener("blur", function() {
			if (isNotValidTitle(inputTitle)) {
				document.getElementById("title-error").style.display = "block";
				inputTitle.style.borderColor = "red";
			} else {
				document.getElementById("title-error").style.display = "none";
				inputTitle.style.borderColor = "black";
			}
		});

		inStartDate.addEventListener("blur", function() {
			checkDates(inStartDate, inEndDate);
		});
		
		inEndDate.addEventListener("blur", function() {
			checkDates(inStartDate, inEndDate);
		});
		
		function checkDates(startDate, endDate) {
			if (!isDateSmaller(inStartDate,inEndDate)) {
				document.getElementById("startdate-error").style.display = "block";
				inEndDate.style.borderColor = "red";
				document.getElementById("startdate-error").style.display = "block";
				inStartDate.style.borderColor = "red";
			} else {
				document.getElementById("startdate-error").style.display = "none";
				inEndDate.style.borderColor = "black";
				document.getElementById("startdate-error").style.display = "none";
				inStartDate.style.borderColor = "black";
			}
		}
		
	</script>
	
</body>
</html>